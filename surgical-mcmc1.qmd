---
title: "Surgical - 1er exemple"
format: pdf
editor: visual
---

```{r}
gibbs1 = function(nchain){
  n = c(47, 148, 119, 810,   211, 196, 148, 215, 207, 97, 256, 360)
  r = c(0, 18, 8, 46, 8, 13, 9,   31, 14, 8, 29, 24)
  N = 12 #nombre d'hopitaux
  
  chain = matrix(0.5, nchain + 1, N) #p1, ..., p12
  
  for (i in 1:nchain){
    pi = chain[i,]
    #pour chaque hopital (N)
    for (j in 1:N){
      pi[j] = rbeta(1, r[j]+1, n[j] - r[j] +1)
    }
    #store new states
    chain[i+1,] = pi 
  }
  return(chain)
}
```

```{r}
chain = gibbs1(11000)

#brunin
chain = chain[1001:11001,]
plot(mcmc(chain))
```

```{r}
apply(chain, 2, mean)
apply(chain, 2, sd)
```
